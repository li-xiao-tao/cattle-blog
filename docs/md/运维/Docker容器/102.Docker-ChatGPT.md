---
# 标签
tag:
  - docker
tags:
  - chatgpt
# 作者
author: 豆浆吃甜的
#标题
title: 搭建个人ChatGPT
# 描述
description: 简单介绍主题的由来和实现原理
# 是否展示图片
hiddenCover: true
# 展示的图片
cover: /public/logo.png
# 精选文章
sticky: 1
---

# Docker-ChatGPT

- yidadaa/chatgpt-next-web
- chenzhaoyu94/chatgpt-web
- [没有账号可以看这个](https://chat-shared.zhile.io/shared.html)
- 代理必须搭建在外服

:::=tabs
::搭建代理

- 搭建代理

```sh
version: '3'
services:
  go-chatgpt-api:
    container_name: go-chatgpt-api
    image: linweiyuan/go-chatgpt-api
    ports:
      - 16956:8080 # 宿主机8080端口可按需改为其它端口
    environment:
      - GIN_MODE=release
      - CHATGPT_PROXY_SERVER=http://chatgpt-proxy-server:9515
    depends_on:
      - chatgpt-proxy-server
    restart: unless-stopped

  chatgpt-proxy-server:
    container_name: chatgpt-proxy-server
    image: linweiyuan/chatgpt-proxy-server
    restart: unless-stopped
```

- 开放端口，重新加载防火墙

```sh
firewall-cmd --zone=public --add-port=16956/tcp --permanent && \
firewall-cmd --reload
```

- 代理地址`<你的外服IP:16956>`

::chatgpt-next-web

- https://github.com/Yidadaa/ChatGPT-Next-Web

- 推荐使用，页面UI精美，需要OPENAI_API_KEY
- `CODE="密码[多个逗号隔开]"`
- `OPENAI_API_KEY="key" `
- `BASE_URL` OpenAI 接口代理 URL。
- `PROTOCOL` OpenAI 接口协议。

```sh
docker run -d -p 3000:3000 \
--name chatgpt-next-web \
-e CODE="admin" \
-e OPENAI_API_KEY="key" \
yidadaa/chatgpt-next-web
```

::①chatgpt-web

## 2.chenzhaoyu94/chatgpt-web

- https://github.com/Chanzhaoyu/chatgpt-web
- `OPENAI_API_KEY`（和下面二选一）
- `OPENAI_ACCESS_TOKEN`（和上面二选一）
    - 获取自己的accessToken链接https://chat.openai.com/api/auth/session

- `API_REVERSE_PROXY`（可选，设置反向代理）
- `OPENAI_API_MODEL`（可选，设置模型）
    - gpt-3.5-turbo（默认）
    - gpt-4

## 2.1 OPENAI_API_KEY模式

```sh
docker run -d \
--restart always \
--name chatgpt-web \
-e OPENAI_API_KEY='key' \
-p 3002:3002 \
chenzhaoyu94/chatgpt-web:main
```

## 2.2 OPENAI_ACCESS_TOKEN模式

```sh
docker run --name chatgpt-web \
--restart unless-stopped \
-p 3002:3002 \
-e OPENAI_ACCESS_TOKEN="获取自己的accessToken链接https://chat.openai.com/api/auth/session" \
-e API_REVERSE_PROXY= "代理地址" \
-d chenzhaoyu94/chatgpt-web 
```

::②chatgpt-web

- https://github.com/Kerwin1202/chatgpt-web
- 在`chenzhaoyu94/chatgpt-web`基础上增加注册登录，数据库保存问题信息

```sh
version: '3'

services:
  chatgpt-web:
    # 建议使用v2.12.4或以上的版本
    # 这个旧版本也稳： kerwin1202/chatgpt-web@sha256:851b6b9f3c592d8a82a9e3ed5519ed4d7b6f653b509f88b0a5de38fe335ff5f5
    image: kerwin1202/chatgpt-web:latest
    container_name: chatgpt-web
    restart: unless-stopped
    ports:
      - 3002:3002
    depends_on:
      - database
    environment:
      TZ: Asia/Shanghai
      # 访问jwt加密参数，可选 不为空则允许登录 同时需要设置 MONGODB_URL
      AUTH_SECRET_KEY: xxxx # 按需修改
      # 你的openai access token
      OPENAI_ACCESS_TOKEN: "获取自己的accessToken链接https://chat.openai.com/api/auth/session"
      # OpenAI绕过Cloudflare验证的反向代理
      API_REVERSE_PROXY: "代理地址自己搭建的"
      # 超时，单位毫秒，可选
      TIMEOUT_MS: 60000
      # 网站名
      SITE_TITLE: chatgpt-web # 按需修改。写个自己喜欢的名字就行
      # mongodb 的连接字符串
      MONGODB_URL: 'mongodb://user01:password01@database:27017' # 按需修改
      # 网站是否开启注册
      REGISTER_ENABLED: true # 完成注册后，这一项要改为false
      # 开启注册之后 网站注册允许的邮箱后缀 如果空 则允许任意后缀
      REGISTER_MAILS: '@qq.com,@gmail.com,@163.com' # 按需修改
      # 加密盐。算法： echo -n 'passwordsalt' | md5sum | cut -c 1-32
      PASSWORD_MD5_SALT: tNJ%M&D # 按需修改
      # 开启注册之后 超级管理员的邮箱
      ROOT_USER: admin@qq.com # 按需修改
      # 开启注册之后网站域名 不含 / 。注册的时候发送验证邮箱使用
      SITE_DOMAIN: https://xxxxx/ # 按需修改
      # 开启注册之后 发送验证邮箱配置
      SMTP_HOST: smtp.qq.com
      SMTP_PORT: 587 # 也可以尝试587
      SMTP_TSL: true
      SMTP_USERNAME: admin@qq.com # 按需修改
      SMTP_PASSWORD: xxx # 按需修改
    links:
      - database

  database:
    image: mongo:3.6
    restart: unless-stopped
    expose:
      - '27017'
    volumes:
      - ./mongodb:/data/db
    environment:
      MONGO_INITDB_ROOT_USERNAME: user01
      MONGO_INITDB_ROOT_PASSWORD: password01
      MONGO_INITDB_DATABASE: chatgpt

  mongo-express:
    image: mongo-express:1.0.0-alpha
    restart: unless-stopped
    ports:
      - "1005:8081"
    environment:
      # 选择主题。详见： http://codemirror.net/demo/theme.html
      ME_CONFIG_OPTIONS_EDITORTHEME: ambiance
      # 数据库信息
      ME_CONFIG_BASICAUTH_USERNAME: user02
      ME_CONFIG_BASICAUTH_PASSWORD: password02
      ME_CONFIG_MONGODB_URL: 'mongodb://user01:password01@database:27017'
      ME_CONFIG_MONGODB_ENABLE_ADMIN: true # 可能不是必要的
      ME_CONFIG_MONGODB_ADMINUSERNAME: user01 # 可能不是必要的
      ME_CONFIG_MONGODB_ADMINPASSWORD: password01 # 可能不是必要的
```

:::
